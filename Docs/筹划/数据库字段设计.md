# 数据库字段设计
## 介绍

三个任务角色各一张表
- student
- teacher
- admin

课程/课题一张表
- course

推送的消息一张表
- message

## 表格数据字段
### student 学生信息表格
```
{
    id: 1,  // 自增ID
    uid: "2123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735", // 自己设置的uid
    wuid: "213sadsad5asd5sdfdsfs", // 微信的uid来标识唯一的微信号
    admin_id: "0123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735",   // 属于哪个教务科

    school: "华中科技大学",
    institute: "电子信息与通信学院",
    major: "通信工程"; // 正常的三级结构划分

    direction： "无线网络";  // 同一个专业更细粒度的专业方向划分

    // 学生基本个人信息,需要认证的2个字段
    name: "WilsonLiu", // 学生姓名
    student_no: "U201313759", // 学号
    // 以上为导入教务科EXCEL生成，不可更改

    // 以下为用户自己填写
    phone: "18571639914",
    intro: "21世界最帅王者", // 个人介绍
    
    // 以下字段为用户操作产生 
    select_course: [courseId1,courseId2] // 已选课题
    confirm_course: courseId, // 最后确认课题

}
```

### teacher 老师信息表格
```
{
    id: 1,  // 自增ID
    uid: "1123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735", // 自己设置的uid
    wuid: "213sadsad5asd5sdfdsfs", // 微信的uid来标识唯一的微信号
    admin_id: "0123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735",  // 属于哪个教务科

    school: "华中科技大学",
    institute: "电子信息与通信学院",
    level: "副教授", 

    // 待确认@TODO 每个老师的课题总数以及每个对应方向的课题数
    direction： ["无线网络","互联网","大数据"];  // 同一个专业更细粒度的专业方向划分

    // 老师基本个人信息,需要认证的2个字段
    name: "许炜", // 学生姓名
    teacher_no: "U201313759", // 学号
    // 以上为导入教务科EXCEL生成，不可更改

    // 以下为用户自己填写
    phone: "18571639914",
    intro: "微助教创始人，连续创业者", // 个人介绍
    
    // 以下字段为用户操作产生 
    course: [courseId1,courseId2] // 新建的课题
    
}
```

### admin 教务科PC管理系统的信息
待确认@TODO 目前的设计是同一个教务科每年录入时，会重新创建账户。以方便数据库设计
```
{
    id: 1,  // 自增ID
    uid: "0123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735", // 自己设置的uid
    create_time: "2016-09-13 00:00:00",
    // 院系基本信息,之后遍历本表获取当前有哪些学校，缓存到redis中

    school: "华中科技大学",
    institute: "电子信息与通信学院", 
    grade: "2013", // 为考虑扩展性，未来可在2013后加注本科或者研究生，不另外设置字段。如"2013-本科"
    
    // 账户密码，excel导入生成
    account: "527622467@qq.com",
    password: "testtest",
    
    // 选课对外开放时间，开放时间内，提供注册，选课等功能，之后只能查看
    start_date: "2016.05.03",
    end_date: "2016.06.30",

    // 个性化参数
    course_num: 6, // 每个老师拥有的课题数
    select_max_num: 2, // 每个学生可以同时选择的课题数

}
```

### course 课程信息表格
```
{
    id: 2, // 自增ID
    admin_id: "0123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735",   // 属于哪个教务科的课程
    teacher_id: "1123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735", // 创建该课程的老师ID

    create_time: "2016-09-13 00:00:00",
    update_time: "2016-09-14 00:00:00", // 仅限于老师编辑时更新
    
    // 课程信息
    teacherName: "许炜",  // 允许数据冗余，减少查表操作
    teacherPhone: "18585858888",
    direction: "互联网", // 课程的所属方向
    
    finalHeadCount: 2, // 最终需要的人数
    currentHead: 0, // 当前选了该课程的人数
    status: 0, // 状态包含 0:编辑中,1:进行中,2:已选定 待确认@TODO 是否需要删除课程的功能，还是创建后仅限修改

    // 课程介绍  待确认@TODO 还需要哪些课程属性 
    title: "基于微信的毕设选题系统", 
    briefIntro: "基于微信设计一套可以提供师生双方互选毕业设计课题的系统", // 简介
    details: "详情、、、、、、", // 详情

}
```

### message 推送消息表格
```
{
    id: 3, 
    event_person_type: 1, // 造成该事件人的类型，0代表教务科，1代表老师，2代表学生
    event_person_id: "1123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735", // 造成该事件人的ID
    
    send_person_type: 2, // 推送给哪类人。0代表教务科，1代表老师，2代表学生
    send_status: 0,// 推送状态,0代表未推送，1代表推送中，2表示全部推送完成
    // 该消息推送的人的id数组 
    send_person_id: ["2123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735", "2123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc732"], 
    
    create_time: "2016-09-13 00:00:00",
    update_time: "2016-09-14 00:00:00", // 推送时更新
    
    content: "你选择的《基于微信的毕设选题系统》课程，老师已选定，已自动帮您退选", 
}
```

redis内存中维护一个学生消息对象
```
{
    "2123818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735": [3,4,5,6], // 以学生ID为键值,值为存储待推送消息的数组
    "2323818af58c015a34b78652f5fb90d7e304a2d825656542733725147fcfc735": [1,4,5,6] 
    
}
```
